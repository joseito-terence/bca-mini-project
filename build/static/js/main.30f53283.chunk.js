(this["webpackJsonpbca-mini-project"]=this["webpackJsonpbca-mini-project"]||[]).push([[0],{28:function(e,a,t){e.exports=t(47)},33:function(e,a,t){},34:function(e,a,t){},39:function(e,a,t){},44:function(e,a,t){},45:function(e,a,t){},46:function(e,a,t){},47:function(e,a,t){"use strict";t.r(a);var n=t(2),o=t.n(n),c=t(26),r=t.n(c),s=t(12),i=t(18),l=t(6),m=(t(33),t(16)),d=(t(34),t(13)),u=d.a.initializeApp({apiKey:"AIzaSyDyYaHKx6PlZ15-LpEzSy-nTkZboo7Cyo0",authDomain:"bca-mini-project.firebaseapp.com",databaseURL:"https://bca-mini-project.firebaseio.com",projectId:"bca-mini-project",storageBucket:"bca-mini-project.appspot.com",messagingSenderId:"555954627693",appId:"1:555954627693:web:eb414234d94d0dd83b0b64",measurementId:"G-XKJSW0TRCS"}).firestore(),f=d.a.auth(),p=new d.a.auth.GoogleAuthProvider,h=u;t(39);var v=function(e){var a=e.roomId,t=e.messageId,n=e.name,c=e.message,r=e.timestamp,s=e.person;return o.a.createElement("div",{className:"message message__".concat(s)},o.a.createElement("span",{className:"message__name"},n),c,o.a.createElement("span",{className:"message__timestamp"},null===r||void 0===r?void 0:r.toDate().toString().slice(0,21)),o.a.createElement("button",{className:"message__deleteBtn",onClick:function(){window.confirm("Delete this message?")&&h.collection("rooms").doc(a).collection("messages").doc(t).delete()}},o.a.createElement("i",{className:"fas fa-trash"})))};var g=function(e){var a=e.noneSelected,t=Object(n.useState)(""),c=Object(s.a)(t,2),r=c[0],i=c[1],u=Object(l.f)().roomId,f=Object(n.useState)(""),p=Object(s.a)(f,2),g=p[0],E=p[1],b=Object(n.useState)([]),N=Object(s.a)(b,2),w=N[0],_=N[1],y=d.a.auth().currentUser;function j(e){document.querySelector(e).scrollIntoView({behavior:"smooth"})}Object(n.useEffect)((function(){u&&(h.collection("rooms").doc(u).onSnapshot((function(e){E(e.data().name)})),h.collection("rooms").doc(u).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){_(e.docs.map((function(e){return Object(m.a)(Object(m.a)({},e.data()),{},{id:e.id})})))})))}),[u]),Object(n.useEffect)((function(){a||j(".chatBottom")}));var S=function(){return Math.floor(255*Math.random())};return a?o.a.createElement("div",{className:"chat"},o.a.createElement("div",{className:"noneSelected"},o.a.createElement("h3",null,"Select a Room to start Messaging"))):o.a.createElement("div",{className:"chat"},o.a.createElement("div",{className:"chat__header"},o.a.createElement("div",{className:"IconButton chat__backBtn",onClick:function(){j(".sidebar__header")}},o.a.createElement("i",{className:"fas fa-arrow-left"})),o.a.createElement("div",{className:"sidebarRoom__avatar",style:{backgroundColor:"rgb(".concat(S(),",").concat(S(),",").concat(S(),")")}},g[0]),o.a.createElement("h3",{className:"chat__headerName"},g),o.a.createElement("div",{className:"IconButton",onClick:function(){window.confirm("Are you sure that you want to delete this room?")&&h.collection("rooms").doc(u).delete().then((function(){window.location.href="/"})).catch((function(){console.error("Unable to delete room.")}))}},o.a.createElement("i",{className:"fas fa-trash"}))),o.a.createElement("div",{className:"chat__body"},w.map((function(e){return o.a.createElement(v,{roomId:u,messageId:e.id,name:e.name,message:e.message,timestamp:e.timestamp,person:e.name===y.displayName&&"sender"})})),o.a.createElement("span",{className:"chatBottom"})),o.a.createElement("div",{className:"chat__footer"},o.a.createElement("form",null,o.a.createElement("input",{value:r,onChange:function(e){return i(e.target.value)},type:"text",placeholder:"Type a message"}),o.a.createElement("button",{onClick:function(e){e.preventDefault(),""!==r&&h.collection("rooms").doc(u).collection("messages").add({message:r,name:y.displayName,timestamp:d.a.firestore.FieldValue.serverTimestamp()}).then((function(){j(".chatBottom")})),i("")},type:"submit"},o.a.createElement("i",{className:"fas fa-paper-plane"})))))};t(44);var E=function(){return o.a.createElement("div",{className:"login"},o.a.createElement("div",{className:"login__container"},o.a.createElement("img",{src:"logo512.png",alt:""}),o.a.createElement("div",{className:"login__text"},o.a.createElement("h1",null,"BCA-MINI-PROJECT"),o.a.createElement("p",null,"A Room-Based Chat App")),o.a.createElement("button",{onClick:function(){f.signInWithPopup(p).then((function(){return window.location.href="/"})).catch((function(e){return alert(e.message)}))}},o.a.createElement("img",{className:"gIcon",src:"https://developers.google.com/identity/images/g-logo.png",height:"25",width:"25",alt:""}),"Sign In With Google"),o.a.createElement("div",{className:"login__footer"},o.a.createElement("p",null,"Developed By: Joseito Fernandes"),o.a.createElement("p",null,"Rollno: R/BCA-18-208"))))};t(45),t(46);var b=function(e){var a=e.id,t=e.name,c=e.addNewRoom,r=Object(n.useState)(""),l=Object(s.a)(r,2),m=l[0],u=l[1];Object(n.useEffect)((function(){var e;return a&&(e=h.collection("rooms").doc(a).collection("messages").orderBy("timestamp","desc").limit(1).onSnapshot((function(e){var a;u(null===(a=e.docs.map((function(e){return e.data()}))[0])||void 0===a?void 0:a.message)}))),function(){a&&e()}}),[a]);var f=function(){return Math.floor(255*Math.random())};return c?o.a.createElement("div",{className:"sidebarRoom",onClick:function(){var e=prompt("Please enter name for the room");e?h.collection("rooms").add({name:e,timestamp:d.a.firestore.FieldValue.serverTimestamp()}):alert("Room Name can't be empty.")}},o.a.createElement("h3",null,o.a.createElement("i",{className:"fas fa-plus"})," New Room")):o.a.createElement(i.b,{to:"/rooms/".concat(a),activeClassName:"sidebarRoom-active",className:"sidebarRoom",id:t},o.a.createElement("div",{className:"sidebarRoom__avatar",style:{backgroundColor:"rgb(".concat(f(),",").concat(f(),",").concat(f(),")")}},t[0]),o.a.createElement("div",{className:"sidebarRoom__info"},o.a.createElement("h2",null,t),o.a.createElement("p",null,(null===m||void 0===m?void 0:m.length)>20?"".concat(m.slice(0,20),"..."):m)))};var N=function(e){var a=e.user,t=Object(n.useState)([]),c=Object(s.a)(t,2),r=c[0],i=c[1];return Object(n.useEffect)((function(){var e=h.collection("rooms").orderBy("timestamp","desc").onSnapshot((function(e){i(e.docs.map((function(e){return Object(m.a)(Object(m.a)({},e.data()),{},{id:e.id})})))}));return function(){e()}}),[]),o.a.createElement("div",{className:"sidebar"},o.a.createElement("div",{className:"sidebar__header"},o.a.createElement("img",{className:"sidebar__avatar",src:a.photoURL,alt:""}),o.a.createElement("div",{className:"sidebar__headerInfo"},o.a.createElement("h3",null,a.displayName),o.a.createElement("p",null,a.email)),o.a.createElement("div",{className:"IconButton",onClick:function(){window.confirm("Do you want to Sign Out?")&&f.signOut().then((function(){window.location.href="/"}))}},o.a.createElement("i",{className:"fas fa-sign-out-alt"}))),o.a.createElement("div",{className:"sidebar__search"},o.a.createElement("div",{className:"sidebar__searchBox"},o.a.createElement("i",{className:"fas fa-search"}),o.a.createElement("input",{placeholder:"Search for room",type:"text",onKeyUp:function(e){for(var a=e.target.value.toLowerCase(),t=document.querySelectorAll(".sidebarRoom"),n=1;n<t.length;n++){var o=t[n].id.toLowerCase();t[n].style.display=o.includes(a)?"flex":"none"}}}))),o.a.createElement("div",{className:"sidebar__rooms"},o.a.createElement(b,{addNewRoom:!0}),r.map((function(e){return o.a.createElement(b,{key:e.id,id:e.id,name:e.name})}))))};var w=function(){var e=Object(n.useState)(),a=Object(s.a)(e,2),t=a[0],c=a[1];return Object(n.useEffect)((function(){var e=f.onAuthStateChanged((function(e){c(e?{displayName:e.displayName,email:e.email,photoURL:e.photoURL}:null)}));return function(){e()}}),[]),o.a.createElement("div",{className:"App"},t?o.a.createElement("div",{className:"app__body"},o.a.createElement(i.a,null,o.a.createElement(N,{user:t}),o.a.createElement(l.c,null,o.a.createElement(l.a,{path:"/rooms/:roomId"},o.a.createElement(g,null)),o.a.createElement(l.a,{path:"/"},o.a.createElement(g,{noneSelected:!0}))))):o.a.createElement(E,null))},_=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function y(e,a){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),a&&a.onUpdate&&a.onUpdate(e)):(console.log("Content is cached for offline use."),a&&a.onSuccess&&a.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}r.a.render(o.a.createElement(w,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var a="".concat("","/service-worker.js");_?(!function(e,a){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(t){var n=t.headers.get("content-type");404===t.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):y(e,a)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(a,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):y(a,e)}))}}()}},[[28,1,2]]]);
//# sourceMappingURL=main.30f53283.chunk.js.map